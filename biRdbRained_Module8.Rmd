---
title: "biRdbRained"
author: "Elizabeth Breitmeyer, Ana Pirosca, Georgia Sisk, Letacianna Stoudmire"
date: "2023-11-29"
output: html_document
bibliography: BIOL3140.bib
---
## Introduction
Climate change is a phenomenon that is dramatically impacting the natural world. Anthropogenic climate change has led to increases in mean annual global temperature which can have catastrophic impacts on the biosphere. For these reasons, it is important to investigate how climate change and shifting global temperatures are affecting different species.

Birds, as a group, have been extensively studied by scientists and civilians alike. In particular, migrating birds have garnered much attention. In the spring in the northern hemisphere, many neotropical passerines take a long-distance migration from Central/South America to higher, more temperate latitudes in order to forage and breed. Some of these species fly over the Gulf of Mexico and are referred to as trans-Gulf migrants (TGMs).The date that these migrants arrive at these breeding grounds is extremely important in terms of fitness. With climate change leading to warmer springs, it may be important for TGMs to shift their arrival date at breeding grounds or they may face population declines.

Previous research by @miller2008bird used 33 years of bird capture data from Manomet, Massachusetts to assess variation in spring migration times for 32 species of North American passerines. They found that migration times of many species occurred earlier over time, and several species' migration times were correlated with spring temperatures. Similarly, we seek to study the effect of local weather conditions on the arrival time of five species of trans-Gulf migrants in Massachusetts. The following five species were studied:

* Belted kingfisher, *Megaceryle alcyon*
* Common nighthawk, *Chordeiles minor*
* Marsh wren, *Cistothorus palustris*
* Olive-sided flycatcher, *Contopus cooperi*
* Scarlet tanager, *Piranga olivacea*

Ultimately our study sought to answer the following questions:

1. Does arrival time vary according to temperature and wind variables along migration route for trans-Gulf migrants migrating to Massachusetts?
2. If arrival time does vary with meteorological conditions, what role will climate change potentially play in the population status of TGMs arriving in MA during the spring?
3. What role do climatic variables play in long-distance migration in passerine birds?

## Methods
Occurrence data for five selected species of TGMs was gathered using the rgbif package. Logistic modeling operations were then used to predict the Julian day on which 25% of the population of the species arrives each year. The NOAA's NCDC API enabled identification of weather stations along the TGMs' migration path to Boston, and weather data from each station was collected. The effect of weather parameters on the arrival time was evaluated using linear mixed-effect modeling from the lme4 package. The car package was then used to perform an anova analysis of the interactions in order to determine the significance of the fixed effects.

## Results
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rgbif)
library(tidyverse)
library(MuMIn)
library(rnoaa)
library(data.table)
library(ggmap)
library(usmap)
library(magick)
library(cowplot)
library(lme4)
library(car)
library(data.table)
```

```{r, echo=FALSE}
kingfisher <- occ_data(scientificName = "Megaceryle alcyon", stateProvince="Massachusetts", limit=200,year=2019)
nighthawk <- occ_data(scientificName = "Chordeiles minor", stateProvince="Massachusetts", limit=200,year=2019)
wren <- occ_data(scientificName = "Cistothorus palustris", stateProvince="Massachusetts", limit=200,year=2019)
flycatcher <- occ_data(scientificName = "Contopus cooperi", stateProvince="Massachusetts", limit=200,year=2019)
tanager <- occ_data(scientificName = "Piranga olivacea", stateProvince="Massachusetts", limit=200,year=2019)

MA<- map_data('state', 'massachusetts')

kingfisher.p <- ggplot(MA, aes(long,lat,group=subregion) )+
  geom_polygon(colour = "gray",fill="gray90")+geom_point(data=kingfisher[[2]],aes(x=decimalLongitude,y=decimalLatitude,size=individualCount),alpha=0.3,inherit.aes = F)+ coord_quickmap()+theme_void()
nighthawk.p <- ggplot(MA, aes(long,lat,group=subregion) )+
  geom_polygon(colour = "gray",fill="gray90")+geom_point(data=nighthawk[[2]],aes(x=decimalLongitude,y=decimalLatitude,size=individualCount),alpha=0.3,inherit.aes = F)+ coord_quickmap()+theme_void()
wren.p <- ggplot(MA, aes(long,lat,group=subregion) )+
  geom_polygon(colour = "gray",fill="gray90")+geom_point(data=wren[[2]],aes(x=decimalLongitude,y=decimalLatitude,size=individualCount),alpha=0.3,inherit.aes = F)+ coord_quickmap()+theme_void()
flycatcher.p <- ggplot(MA, aes(long,lat,group=subregion) )+
  geom_polygon(colour = "gray",fill="gray90")+geom_point(data=flycatcher[[2]],aes(x=decimalLongitude,y=decimalLatitude,size=individualCount),alpha=0.3,inherit.aes = F)+ coord_quickmap()+theme_void()
tanager.p <- ggplot(MA, aes(long,lat,group=subregion) )+
  geom_polygon(colour = "gray",fill="gray90")+geom_point(data=tanager[[2]],aes(x=decimalLongitude,y=decimalLatitude,size=individualCount),alpha=0.3,inherit.aes = F)+ coord_quickmap()+theme_void()

#kingfisher
kingfisher.p2 <- ggdraw()+ draw_plot(kingfisher.p)
print(kingfisher.p2)
#nighthawk
nighthawk.p2 <- ggdraw()+ draw_plot(nighthawk.p)
print(nighthawk.p2)
#wren
wren.p2 <- ggdraw()+ draw_plot(wren.p)
print(wren.p2)
#flycatcher
flycatcher.p2 <- ggdraw()+ draw_plot(flycatcher.p)
print(flycatcher.p2)
#tanager
tanager.p2 <- ggdraw()+ draw_plot(tanager.p)
print(tanager.p2)
````

```{r, eval=FALSE,echo=FALSE,warning=FALSE, message=FALSE}
species <- c("Megaceryle alcyon","Chordeiles minor","Cistothorus palustris","Contopus cooperi","Piranga olivacea")
y <- paste0("1999",",","2019")
m <- paste0("3",",","6")
dat.l <-list()
for(s in species){
  n.obs <-  occ_data(scientificName = s, year = y, month = m, limit = 0, country = "US", basisOfRecord = "HUMAN_OBSERVATION", stateProvince="Massachusetts")$meta$count
print(n.obs)
dat.l[[paste0(s)]] <- occ_data(scientificName = s, year = y, month = m, 
                               limit = n.obs, country = "US",
                               basisOfRecord = "HUMAN_OBSERVATION",
                               stateProvince = "Massachusetts")[[2]]
}
```
```{r, eval=FALSE,include=FALSE,warning=FALSE,message=FALSE}
dat <- rbindlist(dat.l,fill=T)
saveRDS(dat,"massbird.data.RDS")
```

```{r species count vs year,echo=FALSE,warning=FALSE,message=FALSE, fig.cap= "**Fig. 2.** Occurence of five TGM species in Massachusetts from 1990 to 2019."} 
dat <- readRDS("massbird.data.RDS")
dat%>%
  group_by(year,species)%>%
  summarise(count=sum(individualCount,na.rm = T))%>%
  ggplot(aes(x=year,y=count,col=species))+geom_point()
```
## Discussion

## Author Contributions
Elizabeth: Introduction section

Ana:

Georgia: Methods section

Letacianna: Results

## References